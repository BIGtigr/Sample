

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>matrix_builder Module &mdash; Pyvolve 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Pyvolve 1.0 documentation" href="index.html"/>
        <link rel="up" title="Python modules in pyvolve" href="modules.html"/>
        <link rel="next" title="evolver Module" href="evolver.html"/>
        <link rel="prev" title="state_freqs Module" href="state_freqs.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> Pyvolve</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Python modules in <cite>pyvolve</cite></a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="genetics.html"><code class="docutils literal"><span class="pre">genetics</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="newick.html"><code class="docutils literal"><span class="pre">newick</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="model.html"><code class="docutils literal"><span class="pre">model</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="partition.html"><code class="docutils literal"><span class="pre">partition</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="state_freqs.html"><code class="docutils literal"><span class="pre">state_freqs</span></code> Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href=""><code class="docutils literal"><span class="pre">matrix_builder</span></code> Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="evolver.html"><code class="docutils literal"><span class="pre">evolver</span></code> Module</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Pyvolve</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="modules.html">Python modules in <cite>pyvolve</cite></a> &raquo;</li>
      
    <li><code class="docutils literal"><span class="pre">matrix_builder</span></code> Module</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/matrix_builder.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="module-matrix_builder">
<span id="matrix-builder-module"></span><h1><code class="docutils literal"><span class="pre">matrix_builder</span></code> Module<a class="headerlink" href="#module-matrix_builder" title="Permalink to this headline">¶</a></h1>
<p>This module will generate the Markov chain&#8217;s instantaneous rate matrix, Q.</p>
<dl class="class">
<dt id="matrix_builder.MatrixBuilder">
<em class="property">class </em><code class="descclassname">matrix_builder.</code><code class="descname">MatrixBuilder</code><span class="sig-paren">(</span><em>param_dict</em>, <em>scale_matrix='yang'</em><span class="sig-paren">)</span><a class="headerlink" href="#matrix_builder.MatrixBuilder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Parent class for model instantaneous matrix creation.</p>
<dl class="docutils">
<dt>Child class include the following:</dt>
<dd><ol class="first last arabic">
<li><dl class="first docutils">
<dt><em>aminoAcid_Matrix</em> </dt>
<dd><ul class="first last simple">
<li>Empirical amino acid models (currently, JTT, WAG, and LG).</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>nucleotide_Matrix</em> </dt>
<dd><ul class="first last simple">
<li>Nucleotide models (GTR and nested)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>mechCodon_Matrix</em></dt>
<dd><ul class="first last simple">
<li>So-called mechanistic codon models, which include GY-style and MG-style models (dN/dS models)</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>ECM_Matrix</em></dt>
<dd><ul class="first last simple">
<li>ECM (Kosiol2007) empirical codon model</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><em>mutSel_Matrix</em> </dt>
<dd><ul class="first last simple">
<li>Mutation-selection model (Halpern and Bruno 1998), extended for either codon or nucleotides</li>
</ul>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
<p>Construction requires a single positional argument, <strong>param_dict</strong>. This argument should be a dictionary containing parameters about the substitution process in order to construct the matrix.</p>
<dl class="docutils">
<dt>Optional keyword arguments:</dt>
<dd><ol class="first last arabic simple">
<li><strong>scale_matrix</strong> = &lt;&#8217;yang&#8217;, &#8216;neutral&#8217;, &#8216;False/None&#8217;&gt;. This argument determines how rate matrices should be scaled. By default, all matrices are scaled according to Ziheng Yang&#8217;s approach, in which the mean substitution rate is equal to 1. However, for codon models (GY-style and MG-style), this scaling approach effectively causes sites under purifying selection to evolve at the same rate as sites under positive selection, which may not be desired. Thus, the &#8216;neutral&#8217; scaling option will allow for codon matrices to be scaled such that the mean rate of <em>neutral</em> subsitution is 1. You may also opt out of scaling by providing either False or None to this argument, although this is not recommended.</li>
</ol>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="matrix_builder.aminoAcid_Matrix">
<em class="property">class </em><code class="descclassname">matrix_builder.</code><code class="descname">aminoAcid_Matrix</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#matrix_builder.aminoAcid_Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#matrix_builder.MatrixBuilder" title="matrix_builder.MatrixBuilder"><code class="xref py py-class docutils literal"><span class="pre">matrix_builder.MatrixBuilder</span></code></a></p>
<p>Child class of MatrixBuilder. This class implements functions relevant to constructing amino acid model instantaneous matrices.
Note that all empirical amino acid replacement matrices are in the file empirical_matrices.py.</p>
</dd></dl>

<dl class="class">
<dt id="matrix_builder.nucleotide_Matrix">
<em class="property">class </em><code class="descclassname">matrix_builder.</code><code class="descname">nucleotide_Matrix</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#matrix_builder.nucleotide_Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#matrix_builder.MatrixBuilder" title="matrix_builder.MatrixBuilder"><code class="xref py py-class docutils literal"><span class="pre">matrix_builder.MatrixBuilder</span></code></a></p>
<p>Child class of MatrixBuilder. This class implements functions relevant to constructing nucleotide model instantaneous matrices.
All models computed here are essentially nested versions of GTR.</p>
</dd></dl>

<dl class="class">
<dt id="matrix_builder.mechCodon_Matrix">
<em class="property">class </em><code class="descclassname">matrix_builder.</code><code class="descname">mechCodon_Matrix</code><span class="sig-paren">(</span><em>params</em>, <em>type='GY'</em>, <em>scale_matrix='yang'</em><span class="sig-paren">)</span><a class="headerlink" href="#matrix_builder.mechCodon_Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#matrix_builder.MatrixBuilder" title="matrix_builder.MatrixBuilder"><code class="xref py py-class docutils literal"><span class="pre">matrix_builder.MatrixBuilder</span></code></a></p>
<p>Child class of MatrixBuilder. This class implements functions relevant to &#8220;mechanistic&#8221; (dN/dS) codon models.
Models include both GY-style or MG-style varieties, although users should <em>always specify codon frequencies</em> to class instance!
Both dS and dN variation are allowed, as are GTR mutational parameters (not strictly HKY85).</p>
</dd></dl>

<dl class="class">
<dt id="matrix_builder.mutSel_Matrix">
<em class="property">class </em><code class="descclassname">matrix_builder.</code><code class="descname">mutSel_Matrix</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#matrix_builder.mutSel_Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#matrix_builder.MatrixBuilder" title="matrix_builder.MatrixBuilder"><code class="xref py py-class docutils literal"><span class="pre">matrix_builder.MatrixBuilder</span></code></a></p>
<p>Child class of MatrixBuilder. This class implements functions relevant to constructing mutation-selection balance model instantaneous matrices, according to the HalpernBruno 1998 model.
Here, this model is extended such that it can be used for either nucleotide or codon. This class will automatically detect which one you want based on your state frequencies.</p>
</dd></dl>

<dl class="class">
<dt id="matrix_builder.ECM_Matrix">
<em class="property">class </em><code class="descclassname">matrix_builder.</code><code class="descname">ECM_Matrix</code><span class="sig-paren">(</span><em>params</em>, <em>scale_matrix='yang'</em><span class="sig-paren">)</span><a class="headerlink" href="#matrix_builder.ECM_Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#matrix_builder.MatrixBuilder" title="matrix_builder.MatrixBuilder"><code class="xref py py-class docutils literal"><span class="pre">matrix_builder.MatrixBuilder</span></code></a></p>
<p>Child class of MatrixBuilder. This class implements functions relevant to constructing a matrix specifically for the ECM (described in Kosiol2007) model.
We support both restricted (instantaneous single changes only) and unrestricted (instantaneous single, double, or triple) versions of this model (see paper for details).</p>
<p>!!! NOTE: The ECM model supports omega (dN/dS) and kappa (TI/TV) ratios in their calculations, and therefore I have included these parameters here. HOWEVER, I do NOT recommend their use.</p>
</dd></dl>

</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="evolver.html" class="btn btn-neutral float-right" title="evolver Module">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="state_freqs.html" class="btn btn-neutral" title="state_freqs Module"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Stephanie J. Spielman.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>